//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool
//     Changes to this file will be lost if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------
using SourceProject;
using System;

public class Unit : IUnit {

    private double _defensive;
    private int _lifePoints;
    private double _offensive;
    private int _line;
    private int _column;
    private double _movePoints;

    public Unit() {
        _lifePoints = 5;
        _movePoints = 1;
        _defensive = 1;
        _offensive = 2;
    }

    public virtual void setLifePoints(int value) {
        _lifePoints = value;
    }

    public virtual int getLine() {
        return _line;
    }

    public virtual int getColumn() {
        return _column;
    }

    public virtual double getDefensive() {
        return _defensive * (_lifePoints/5);
    }

    public virtual int getLifePoints() {
        return _lifePoints;
    }

    public virtual double getOffensive() {
        return _offensive * (_lifePoints / 5);
    }

    public virtual int getPoint() {
        throw new System.NotImplementedException();
    }

    public virtual bool move(int line, int column) {
        _line = line;
        _column = column;

        return true;
    }

    public virtual bool attack(int line, int column) {
        throw new System.NotImplementedException();
    }

    public virtual bool hasMoves() {
        return _movePoints > 0;
    }

    public virtual bool attack(Unit defUnit) {

        double pAttWin;
        int result;

        Random random = new Random();
        int nbCombat = random.Next(3, Math.Max(_lifePoints, defUnit.getLifePoints()) + 2);

        for(int i = 0; i < nbCombat; i++) {

            pAttWin = (1 - (0.5 * defUnit.getDefensive() / getOffensive())) * 100;

            if(pAttWin == 100) {
                defUnit.setLifePoints(0);
                return true;
            }

            result = random.Next(0, 100);

            if(result <= pAttWin)
                defUnit.setLifePoints(getLifePoints() - 1);
            else
                _lifePoints--;

            if(!defUnit.isAlive())
                return true;

            if(!isAlive())
                return false;
        }

        return false;
    }

    public virtual bool isAlive() {
        return _lifePoints > 0;
    }
}

